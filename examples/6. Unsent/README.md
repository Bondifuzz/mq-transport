# Multi

## Описание

В данном примере рассматривается следующая проблема: брокер сообщений недоступен, сервис содержит неотправленные сообщения и получает команду на выключение в течение N секунд. Что делать с неотправленными сообщениями, будут ли они навсегда потеряны? Отчаявшиеся могут успокоиться, ведь решение довольно простое: перед выключением экспортировать неотправленные сообщения и сохранить их в другое место; при включении импортировать сообщения и попытаться их отправить.

## Запуск

Для запуска примера нужно выполнить следующие команды:

```bash
# Terminal 1
python3 consumer.py
# Terminal 2
python3 producer.py
```

Для имитации ошибок сети необходимо перейти в корень репозитория и выполнить следующие команды:

```bash
# Ошибка сети
docker-compose -p mqtransport_examples stop

# Сеть восстановлена
docker-compose -p mqtransport_examples start
```

Для демонстрации необходимо запустить сервисы и брокера сообщений, затем выключить брокера и завершить *producer*. Неотправленные сообщения сохранятся на диск.